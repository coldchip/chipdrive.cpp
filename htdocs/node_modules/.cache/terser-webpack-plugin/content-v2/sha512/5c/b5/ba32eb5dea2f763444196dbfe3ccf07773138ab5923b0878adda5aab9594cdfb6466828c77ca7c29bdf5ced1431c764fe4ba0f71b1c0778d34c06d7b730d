{"code":"!function(e){function t(t){for(var o,a,i=t[0],c=t[1],s=t[2],u=0,p=[];u<i.length;u++)a=i[u],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&p.push(r[a][0]),r[a]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(d&&d(t);p.length;)p.shift()();return l.push.apply(l,s||[]),n()}function n(){for(var e,t=0;t<l.length;t++){for(var n=l[t],o=!0,i=1;i<n.length;i++){var c=n[i];0!==r[c]&&(o=!1)}o&&(l.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},r={0:0},l=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,\"a\",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p=\"\";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var d=c;l.push([1,1]),n()}([,function(e,t,n){\"use strict\";n.r(t);var o=n(0),r=n.n(o),l=(n(2),n(10),n(11),n(12),n(13),n(14),n(15)),a=n(16),i=[\"jpg\",\"png\",\"jpeg\",\"bmp\",\"h264\",\"gif\",\"svg\"],c=[\"mov\",\"mp4\",\"avi\",\"wmv\",\"3gp\",\"mpg\",\"mpeg\"],s=[\"wav\",\"ogg\",\"mp3\",\"m4a\",\"aac\"],d=angular.module(\"chipdrive\",[\"ngMaterial\"]);function u(e,t,n,o,r,l){1==o.type?e.type=\"file\":e.type=\"folder\",e.rename=()=>{r(o),t.cancel()},e.delete=()=>{l(o),t.cancel()},e.download=()=>{var e=n.urlf(\"/api/v1/drive/stream\",{id:o.id,token:n.getToken()}),r=document.createElement(\"a\");r.style.display=\"none\",r.style.height=\"0px\",r.href=e,r.download=o.name,document.body.appendChild(r),r.click(),document.body.removeChild(r),t.cancel()}}function p(e,t,n,o,r){e.chooseFiles=()=>{o(),t.cancel()},e.newFolder=()=>{r(),t.cancel()}}function m(e,t,n,o){e.name=o.name,e.src=n.urlf(\"/api/v1/drive/stream\",{id:o.id,token:n.getToken()});var r=o.name.substr(o.name.lastIndexOf(\".\")+1).toLowerCase();i.indexOf(r)>=0?e.type=\"image\":s.indexOf(r)>=0?e.type=\"audio\":c.indexOf(r)>=0?e.type=\"video\":e.type=\"unknown\",e.cancel=()=>{t.cancel()}}d.directive(\"onChange\",a.onChange),d.factory(\"globals\",l),d.controller(\"chipdrivectrl\",[\"$scope\",\"$mdDialog\",\"globals\",(e,t,n)=>{e.onerror=t=>{\"ERR_LOGIN_REQUIRED\"==t?e.login():(e.showSpinner=!1,e.showError=!0,e.errorMsg=t,e.$apply())},e.list=async t=>{e.items=[],e.showEmptyPlaceholder=!1,e.showSpinner=!0,n.send(n.urlf(\"/api/v1/drive/list\",{folderid:t,token:n.getToken()}),null,null).then(n=>{var o=JSON.parse(n).data.list;e.showSpinner=!1,e.items=o,e.currentFolder=t,0==o.length&&(e.showEmptyPlaceholder=!0),e.$apply()}).catch(t=>{e.onerror(t)})},e.upload=async t=>{e.items=[],e.showProgress=!0;for(var o=0,r=0,l=t.target.files,a=0;a<l.length;a++)o+=l[a].size;for(a=0;a<l.length;a++)try{await n.send(n.urlf(\"/api/v1/drive/upload\",{folderid:e.currentFolder,name:l[a].name,token:n.getToken()}),l[a],t=>{var n=(r+t.loaded)/o*100;e.progress=n.toFixed(2),e.$apply()}),r+=l[a].size}catch(t){e.onerror(t)}e.showProgress=!1,e.list(e.currentFolder)},e.createFolder=()=>{var o=t.prompt().title(\"How would you like to name your new folder?\").textContent(\"\").placeholder(\"NewFolder1\").required(!0).ok(\"Okay\").cancel(\"Cancel\");t.show(o).then((function(t){e.items=[],e.showSpinner=!0,n.send(n.urlf(\"/api/v1/drive/folder\",{folderid:e.currentFolder,name:t,token:n.getToken()}),null,null).then(()=>{e.showSpinner=!1,e.list(e.currentFolder)}).catch(t=>{e.onerror(t)})}))},e.renameItem=o=>{var r=t.prompt().title(\"Rename Item\").textContent(\"\").placeholder(\"\").required(!0).ok(\"Okay\").cancel(\"Cancel\");t.show(r).then((function(t){e.items=[],e.showSpinner=!0,n.send(n.urlf(\"/api/v1/drive/rename\",{itemid:o.id,name:t,token:n.getToken()}),null,null).then(()=>{e.showSpinner=!1,e.list(e.currentFolder)}).catch(t=>{e.onerror(t)})}))},e.deleteItem=o=>{var r=t.confirm().title(\"Delete Item?\").textContent(\"\").ok(\"Okay\").cancel(\"Cancel\");t.show(r).then((function(t){e.items=[],e.showSpinner=!0,n.send(n.urlf(\"/api/v1/drive/delete\",{itemid:o.id,token:n.getToken()}),null,null).then(()=>{e.showSpinner=!1,e.list(e.currentFolder)}).catch(t=>{e.onerror(t)})}))},e.chooseUpload=()=>{r()(\"#upload-hidden\").trigger(\"click\")},e.openItem=(n,o)=>{switch(n.type){case 1:t.show({controller:m,locals:{item:n},templateUrl:\"template/dialog.html\",parent:angular.element(document.body),targetEvent:o,clickOutsideToClose:!0,fullscreen:e.customFullscreen});break;case 2:e.list(n.id)}},e.newItemTrigger=n=>{t.show({controller:p,locals:{chooseUpload:e.chooseUpload,createFolder:e.createFolder},templateUrl:\"template/new.html\",parent:angular.element(document.body),targetEvent:n,clickOutsideToClose:!0,fullscreen:e.customFullscreen})},e.optionsTrigger=(n,o)=>{t.show({controller:u,locals:{item:n,renameItem:e.renameItem,deleteItem:e.deleteItem},templateUrl:\"template/option.html\",parent:angular.element(document.body),targetEvent:o,clickOutsideToClose:!0,fullscreen:e.customFullscreen})},e.login=()=>{n.clearToken();var o=t.prompt({onComplete:()=>{var e=angular.element(document.getElementsByTagName(\"md-input-container\")).children();e[0].style.fontFamily=\"monospace\",e[0].style.fontSize=\"18px\"}}).title(\"Login Required, Enter Token\").placeholder(\"M33gTKz4gDeey...\").required(!0).ok(\"Login\");t.show(o).then((function(t){n.setToken(t),e.list(\"home\")}))},e.list(\"home\")}]),u.$inject=[\"$scope\",\"$mdDialog\",\"globals\",\"item\",\"renameItem\",\"deleteItem\"],p.$inject=[\"$scope\",\"$mdDialog\",\"globals\",\"chooseUpload\",\"createFolder\"],m.$inject=[\"$scope\",\"$mdDialog\",\"globals\",\"item\"]},,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t){e.exports=function(){return{send:(e,t,n)=>new Promise((o,r)=>{var l=new XMLHttpRequest;l.onreadystatechange=function(){4==l.readyState&&(200==l.status?o(l.response):401==l.status?r(\"ERR_LOGIN_REQUIRED\"):r(\"ERR_UNKNOWN_STATUS\"))},l.onerror=function(e){r(e)},l.upload.addEventListener(\"progress\",n),l.open(\"POST\",e,!0),l.send(t)}),urlf:(e,t)=>{var n=e,o=Object.keys(t).length;o>0&&(n+=\"?\");for(var r=0;r<o;r++)n+=encodeURIComponent(Object.keys(t)[r]),n+=\"=\",n+=encodeURIComponent(Object.values(t)[r]),o-1!=r&&(n+=\"&\");return n},getToken:()=>localStorage.getItem(\"token\"),setToken:e=>{localStorage.setItem(\"token\",e)},clearToken:e=>{localStorage.removeItem(\"token\")}}}},function(e,t){e.exports={onChange:function(){return{restrict:\"A\",link:function(e,t,n){var o=e.$eval(n.onChange);t.on(\"change\",o),t.on(\"$destroy\",(function(){t.off()}))}}}}}]);","extractedComments":[]}