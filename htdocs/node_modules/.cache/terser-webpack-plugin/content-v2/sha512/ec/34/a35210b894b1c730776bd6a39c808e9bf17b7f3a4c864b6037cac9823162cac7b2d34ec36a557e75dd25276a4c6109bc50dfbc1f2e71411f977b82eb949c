{"code":"!function(e){function n(n){for(var r,a,i=n[0],c=n[1],s=n[2],p=0,d=[];p<i.length;p++)a=i[p],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&d.push(o[a][0]),o[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(u&&u(n);d.length;)d.shift()();return l.push.apply(l,s||[]),t()}function t(){for(var e,n=0;n<l.length;n++){for(var t=l[n],r=!0,i=1;i<t.length;i++){var c=t[i];0!==o[c]&&(r=!1)}r&&(l.splice(n--,1),e=a(a.s=t[0]))}return e}var r={},o={0:0},l=[];function a(n){if(r[n])return r[n].exports;var t=r[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=e,a.c=r,a.d=function(e,n,t){a.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},a.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},a.t=function(e,n){if(1&n&&(e=a(e)),8&n)return e;if(4&n&&\"object\"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,\"default\",{enumerable:!0,value:e}),2&n&&\"string\"!=typeof e)for(var r in e)a.d(t,r,function(n){return e[n]}.bind(null,r));return t},a.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(n,\"a\",n),n},a.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},a.p=\"\";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=n,i=i.slice();for(var s=0;s<i.length;s++)n(i[s]);var u=c;l.push([1,1]),t()}([,function(e,n,t){\"use strict\";t.r(n);var r=t(0),o=t.n(r),l=(t(2),t(10),t(11),t(12),t(13),t(14),t(15),t(16)),a=t(17),i=[\"jpg\",\"png\",\"jpeg\",\"bmp\",\"h264\",\"gif\",\"svg\"],c=[\"mov\",\"mp4\",\"avi\",\"wmv\",\"3gp\",\"mpg\",\"mpeg\"],s=[\"wav\",\"ogg\",\"mp3\",\"m4a\",\"aac\"],u=angular.module(\"chipdrive\",[\"ngMaterial\"]);function p(e,n,t,r){e.showLogin=!1,e.showOtp=!0,e.toggle=()=>{e.showOtp=!e.showOtp,e.showLogin=!e.showLogin},e.login=()=>{e.errorText=\"Logging In...\",t.send(t.urlf(\"/api/v1/login\",{username:e.username,password:e.password,time:Math.floor((new Date).getTime()/1e3)}),null,null).then(t=>{var o=JSON.parse(t);1==o.success?(n.cancel(),r(null)):(e.errorText=o.reason,e.$apply())}).catch(n=>{e.errorText=n,e.$apply()})},e.loginotp=()=>{e.errorText=\"Logging In...\",t.send(t.urlf(\"/api/v1/loginotp\",{otp:e.otp,time:Math.floor((new Date).getTime()/1e3)}),null,null).then(t=>{var o=JSON.parse(t);1==o.success?(n.cancel(),r(null)):(e.errorText=o.reason,e.$apply())}).catch(n=>{e.errorText=n,e.$apply()})}}function d(e,n,t,r,o,l){1==r.type?e.type=\"file\":e.type=\"folder\",e.rename=()=>{o(r),n.cancel()},e.delete=()=>{l(r),n.cancel()},e.download=()=>{var e=t.urlf(\"/api/v1/drive/stream\",{id:r.id}),o=document.createElement(\"a\");o.style.display=\"none\",o.style.height=\"0px\",o.href=e,o.download=r.name,document.body.appendChild(o),o.click(),document.body.removeChild(o),n.cancel()}}function m(e,n,t,r,o){e.chooseFiles=()=>{r(),n.cancel()},e.newFolder=()=>{o(),n.cancel()}}function f(e,n,t,r){e.name=r.name,e.src=t.urlf(\"/api/v1/drive/stream\",{id:r.id});var o=r.name.substr(r.name.lastIndexOf(\".\")+1).toLowerCase();i.indexOf(o)>=0?e.type=\"image\":s.indexOf(o)>=0?e.type=\"audio\":c.indexOf(o)>=0?e.type=\"video\":e.type=\"unknown\",e.cancel=()=>{n.cancel()}}u.directive(\"onChange\",a.onChange),u.factory(\"globals\",l),u.controller(\"chipdrivectrl\",[\"$scope\",\"$mdDialog\",\"globals\",(e,n,t)=>{e.onerror=n=>{\"ERR_LOGIN_REQUIRED\"==n?e.login():(e.showSpinner=!1,e.showError=!0,e.errorMsg=n,e.$apply())},e.list=async n=>{null==n&&(n=e.root),e.items=[],e.showEmptyPlaceholder=!1,e.showSpinner=!0,t.send(t.urlf(\"/api/v1/drive/list\",{folderid:n}),null,null).then(t=>{var r=JSON.parse(t).data.list;e.showSpinner=!1,e.items=r,e.currentFolder=n,0==r.length&&(e.showEmptyPlaceholder=!0),e.$apply()}).catch(n=>{e.onerror(n)})},e.upload=async n=>{e.items=[],e.showProgress=!0;for(var r=0,o=0,l=n.target.files,a=0;a<l.length;a++)r+=l[a].size;for(a=0;a<l.length;a++)try{await t.send(t.urlf(\"/api/v1/drive/upload\",{folderid:e.currentFolder,name:l[a].name}),l[a],n=>{var t=(o+n.loaded)/r*100;e.progress=t.toFixed(2),e.$apply()}),o+=l[a].size}catch(n){e.onerror(n)}e.showProgress=!1,e.list(e.currentFolder)},e.createFolder=()=>{var r=n.prompt().title(\"How would you like to name your new folder?\").textContent(\"\").placeholder(\"NewFolder1\").required(!0).ok(\"Okay\").cancel(\"Cancel\");n.show(r).then((function(n){e.items=[],e.showSpinner=!0,t.send(t.urlf(\"/api/v1/drive/folder\",{folderid:e.currentFolder,name:n}),null,null).then(()=>{e.showSpinner=!1,e.list(e.currentFolder)}).catch(n=>{e.onerror(n)})}))},e.renameItem=r=>{var o=n.prompt().title(\"Rename Item\").textContent(\"\").placeholder(\"\").required(!0).ok(\"Okay\").cancel(\"Cancel\");n.show(o).then((function(n){e.items=[],e.showSpinner=!0,t.send(t.urlf(\"/api/v1/drive/rename\",{itemid:r.id,name:n}),null,null).then(()=>{e.showSpinner=!1,e.list(e.currentFolder)}).catch(n=>{e.onerror(n)})}))},e.deleteItem=r=>{var o=n.confirm().title(\"Delete Item?\").textContent(\"\").ok(\"Okay\").cancel(\"Cancel\");n.show(o).then((function(n){e.items=[],e.showSpinner=!0,t.send(t.urlf(\"/api/v1/drive/delete\",{itemid:r.id}),null,null).then(()=>{e.showSpinner=!1,e.list(e.currentFolder)}).catch(n=>{e.onerror(n)})}))},e.chooseUpload=()=>{o()(\"#upload-hidden\").trigger(\"click\")},e.openItem=(t,r)=>{switch(t.type){case 1:n.show({controller:f,locals:{item:t},templateUrl:\"template/dialog.html\",parent:angular.element(document.body),targetEvent:r,clickOutsideToClose:!0,fullscreen:e.customFullscreen});break;case 2:e.list(t.id)}},e.newItemTrigger=t=>{n.show({controller:m,locals:{chooseUpload:e.chooseUpload,createFolder:e.createFolder},templateUrl:\"template/new.html\",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,fullscreen:e.customFullscreen})},e.optionsTrigger=(t,r)=>{n.show({controller:d,locals:{item:t,renameItem:e.renameItem,deleteItem:e.deleteItem},templateUrl:\"template/option.html\",parent:angular.element(document.body),targetEvent:r,clickOutsideToClose:!0,fullscreen:e.customFullscreen})},e.login=()=>{n.show({controller:p,locals:{list:e.list},templateUrl:\"template/login.html\",parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:e.customFullscreen})},t.send(t.urlf(\"/api/v1/drive/config\",{}),null,null).then(n=>{var t=JSON.parse(n).data;e.root=t.root,e.list(null)}).catch(n=>{e.onerror(n)})}]),p.$inject=[\"$scope\",\"$mdDialog\",\"globals\",\"list\"],d.$inject=[\"$scope\",\"$mdDialog\",\"globals\",\"item\",\"renameItem\",\"deleteItem\"],m.$inject=[\"$scope\",\"$mdDialog\",\"globals\",\"chooseUpload\",\"createFolder\"],f.$inject=[\"$scope\",\"$mdDialog\",\"globals\",\"item\"]},,,,,,,,,,function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n){e.exports=function(){return{send:(e,n,t)=>new Promise((r,o)=>{var l=new XMLHttpRequest;l.onreadystatechange=function(){4==l.readyState&&(200==l.status?r(l.response):401==l.status?o(\"ERR_LOGIN_REQUIRED\"):o(\"ERR_UNKNOWN_STATUS\"))},l.onerror=function(e){o(e)},l.upload.addEventListener(\"progress\",t),l.open(\"POST\",e,!0),l.send(n)}),urlf:(e,n)=>{var t=e,r=Object.keys(n).length;r>0&&(t+=\"?\");for(var o=0;o<r;o++)t+=encodeURIComponent(Object.keys(n)[o]),t+=\"=\",t+=encodeURIComponent(Object.values(n)[o]),r-1!=o&&(t+=\"&\");return t}}}},function(e,n){e.exports={onChange:function(){return{restrict:\"A\",link:function(e,n,t){var r=e.$eval(t.onChange);n.on(\"change\",r),n.on(\"$destroy\",(function(){n.off()}))}}}}}]);","extractedComments":[]}