{"code":"!function(e){function n(n){for(var o,a,i=n[0],c=n[1],s=n[2],u=0,d=[];u<i.length;u++)a=i[u],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&d.push(r[a][0]),r[a]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);for(p&&p(n);d.length;)d.shift()();return l.push.apply(l,s||[]),t()}function t(){for(var e,n=0;n<l.length;n++){for(var t=l[n],o=!0,i=1;i<t.length;i++){var c=t[i];0!==r[c]&&(o=!1)}o&&(l.splice(n--,1),e=a(a.s=t[0]))}return e}var o={},r={0:0},l=[];function a(n){if(o[n])return o[n].exports;var t=o[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=e,a.c=o,a.d=function(e,n,t){a.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},a.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},a.t=function(e,n){if(1&n&&(e=a(e)),8&n)return e;if(4&n&&\"object\"==typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,\"default\",{enumerable:!0,value:e}),2&n&&\"string\"!=typeof e)for(var o in e)a.d(t,o,function(n){return e[n]}.bind(null,o));return t},a.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(n,\"a\",n),n},a.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},a.p=\"\";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=n,i=i.slice();for(var s=0;s<i.length;s++)n(i[s]);var p=c;l.push([1,1]),t()}([,function(e,n,t){\"use strict\";t.r(n);var o=t(0),r=t.n(o),l=(t(2),t(10),t(11),t(12),t(13),t(14),t(15),t(16)),a=t(17),i=[\"jpg\",\"png\",\"jpeg\",\"bmp\",\"h264\",\"gif\",\"svg\"],c=[\"mov\",\"mp4\",\"avi\",\"wmv\",\"3gp\",\"mpg\",\"mpeg\"],s=[\"wav\",\"ogg\",\"mp3\",\"m4a\",\"aac\"],p=angular.module(\"chipdrive\",[\"ngMaterial\"]);function u(e,n,t,o){e.showLogin=!0,e.showOtp=!1,e.toggle=()=>{e.showOtp=!e.showOtp,e.showLogin=!e.showLogin},e.login=()=>{e.errorText=\"Logging In...\",t.send(t.urlf(\"/api/v1/login\",{username:e.username,password:e.password,time:(new Date).getTime()}),null,null).then(t=>{var r=JSON.parse(t);1==r.success?(n.cancel(),o(\"home\")):(e.errorText=r.reason,e.$apply())}).catch(n=>{e.errorText=n,e.$apply()})},e.loginotp=()=>{e.errorText=\"Logging In...\",t.send(t.urlf(\"/api/v1/loginotp\",{otp:e.otp}),null,null).then(t=>{var r=JSON.parse(t);1==r.success?(n.cancel(),o(\"home\")):(e.errorText=r.reason,e.$apply())}).catch(n=>{e.errorText=n,e.$apply()})}}function d(e,n,t,o,r,l){1==o.type?e.type=\"file\":e.type=\"folder\",e.rename=()=>{r(o),n.cancel()},e.delete=()=>{l(o),n.cancel()},e.download=()=>{var e=t.urlf(\"/api/v1/drive/stream\",{id:o.id}),r=document.createElement(\"a\");r.style.display=\"none\",r.style.height=\"0px\",r.href=e,r.download=o.name,document.body.appendChild(r),r.click(),document.body.removeChild(r),n.cancel()}}function m(e,n,t,o,r){e.chooseFiles=()=>{o(),n.cancel()},e.newFolder=()=>{r(),n.cancel()}}function h(e,n,t,o){e.name=o.name,e.src=t.urlf(\"/api/v1/drive/stream\",{id:o.id});var r=o.name.substr(o.name.lastIndexOf(\".\")+1).toLowerCase();i.indexOf(r)>=0?e.type=\"image\":s.indexOf(r)>=0?e.type=\"audio\":c.indexOf(r)>=0?e.type=\"video\":e.type=\"unknown\",e.cancel=()=>{n.cancel()}}p.directive(\"onChange\",a.onChange),p.factory(\"globals\",l),p.controller(\"chipdrivectrl\",[\"$scope\",\"$mdDialog\",\"globals\",(e,n,t)=>{e.onerror=n=>{\"ERR_LOGIN_REQUIRED\"==n?e.login():(e.showSpinner=!1,e.showError=!0,e.errorMsg=n,e.$apply())},e.list=async n=>{e.items=[],e.showEmptyPlaceholder=!1,e.showSpinner=!0,t.send(t.urlf(\"/api/v1/drive/list\",{folderid:n}),null,null).then(t=>{var o=JSON.parse(t).data.list;e.showSpinner=!1,e.items=o,e.currentFolder=n,0==o.length&&(e.showEmptyPlaceholder=!0),e.$apply()}).catch(n=>{e.onerror(n)})},e.upload=async n=>{e.items=[],e.showProgress=!0;for(var o=0,r=0,l=n.target.files,a=0;a<l.length;a++)o+=l[a].size;for(a=0;a<l.length;a++)try{await t.send(t.urlf(\"/api/v1/drive/upload\",{folderid:e.currentFolder,name:l[a].name}),l[a],n=>{var t=(r+n.loaded)/o*100;e.progress=t.toFixed(2),e.$apply()}),r+=l[a].size}catch(n){e.onerror(n)}e.showProgress=!1,e.list(e.currentFolder)},e.createFolder=()=>{var o=n.prompt().title(\"How would you like to name your new folder?\").textContent(\"\").placeholder(\"NewFolder1\").required(!0).ok(\"Okay\").cancel(\"Cancel\");n.show(o).then((function(n){e.items=[],e.showSpinner=!0,t.send(t.urlf(\"/api/v1/drive/folder\",{folderid:e.currentFolder,name:n}),null,null).then(()=>{e.showSpinner=!1,e.list(e.currentFolder)}).catch(n=>{e.onerror(n)})}))},e.renameItem=o=>{var r=n.prompt().title(\"Rename Item\").textContent(\"\").placeholder(\"\").required(!0).ok(\"Okay\").cancel(\"Cancel\");n.show(r).then((function(n){e.items=[],e.showSpinner=!0,t.send(t.urlf(\"/api/v1/drive/rename\",{itemid:o.id,name:n}),null,null).then(()=>{e.showSpinner=!1,e.list(e.currentFolder)}).catch(n=>{e.onerror(n)})}))},e.deleteItem=o=>{var r=n.confirm().title(\"Delete Item?\").textContent(\"\").ok(\"Okay\").cancel(\"Cancel\");n.show(r).then((function(n){e.items=[],e.showSpinner=!0,t.send(t.urlf(\"/api/v1/drive/delete\",{itemid:o.id}),null,null).then(()=>{e.showSpinner=!1,e.list(e.currentFolder)}).catch(n=>{e.onerror(n)})}))},e.chooseUpload=()=>{r()(\"#upload-hidden\").trigger(\"click\")},e.openItem=(t,o)=>{switch(t.type){case 1:n.show({controller:h,locals:{item:t},templateUrl:\"template/dialog.html\",parent:angular.element(document.body),targetEvent:o,clickOutsideToClose:!0,fullscreen:e.customFullscreen});break;case 2:e.list(t.id)}},e.newItemTrigger=t=>{n.show({controller:m,locals:{chooseUpload:e.chooseUpload,createFolder:e.createFolder},templateUrl:\"template/new.html\",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,fullscreen:e.customFullscreen})},e.optionsTrigger=(t,o)=>{n.show({controller:d,locals:{item:t,renameItem:e.renameItem,deleteItem:e.deleteItem},templateUrl:\"template/option.html\",parent:angular.element(document.body),targetEvent:o,clickOutsideToClose:!0,fullscreen:e.customFullscreen})},e.login=()=>{n.show({controller:u,locals:{list:e.list},templateUrl:\"template/login.html\",parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:e.customFullscreen})},e.list(\"home\")}]),u.$inject=[\"$scope\",\"$mdDialog\",\"globals\",\"list\"],d.$inject=[\"$scope\",\"$mdDialog\",\"globals\",\"item\",\"renameItem\",\"deleteItem\"],m.$inject=[\"$scope\",\"$mdDialog\",\"globals\",\"chooseUpload\",\"createFolder\"],h.$inject=[\"$scope\",\"$mdDialog\",\"globals\",\"item\"]},,,,,,,,,,function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n,t){},function(e,n){e.exports=function(){return{send:(e,n,t)=>new Promise((o,r)=>{var l=new XMLHttpRequest;l.onreadystatechange=function(){4==l.readyState&&(200==l.status?o(l.response):401==l.status?r(\"ERR_LOGIN_REQUIRED\"):r(\"ERR_UNKNOWN_STATUS\"))},l.onerror=function(e){r(e)},l.upload.addEventListener(\"progress\",t),l.open(\"POST\",e,!0),l.send(n)}),urlf:(e,n)=>{var t=e,o=Object.keys(n).length;o>0&&(t+=\"?\");for(var r=0;r<o;r++)t+=encodeURIComponent(Object.keys(n)[r]),t+=\"=\",t+=encodeURIComponent(Object.values(n)[r]),o-1!=r&&(t+=\"&\");return t}}}},function(e,n){e.exports={onChange:function(){return{restrict:\"A\",link:function(e,n,t){var o=e.$eval(t.onChange);n.on(\"change\",o),n.on(\"$destroy\",(function(){n.off()}))}}}}}]);","extractedComments":[]}