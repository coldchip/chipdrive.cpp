!function(e){function n(n){for(var t,a,i=n[0],c=n[1],s=n[2],d=0,p=[];d<i.length;d++)a=i[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&p.push(o[a][0]),o[a]=0;for(t in c)Object.prototype.hasOwnProperty.call(c,t)&&(e[t]=c[t]);for(u&&u(n);p.length;)p.shift()();return l.push.apply(l,s||[]),r()}function r(){for(var e,n=0;n<l.length;n++){for(var r=l[n],t=!0,i=1;i<r.length;i++){var c=r[i];0!==o[c]&&(t=!1)}t&&(l.splice(n--,1),e=a(a.s=r[0]))}return e}var t={},o={0:0},l=[];function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,n,r){a.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,n){if(1&n&&(e=a(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(a.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var t in e)a.d(r,t,function(n){return e[n]}.bind(null,t));return r},a.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(n,"a",n),n},a.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},a.p="";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=n,i=i.slice();for(var s=0;s<i.length;s++)n(i[s]);var u=c;l.push([1,1]),r()}([,function(e,n,r){"use strict";r.r(n);var t=r(0),o=r.n(t),l=(r(2),r(10),r(11),r(12),r(13),r(14),r(15),r(16)),a=r(17),i=["jpg","png","jpeg","bmp","h264","gif","svg"],c=["mov","mp4","avi","wmv","3gp","mpg","mpeg"],s=["wav","ogg","mp3","m4a","aac"],u=angular.module("chipdrive",["ngMaterial"]);function d(e,n,r,t){e.showLogin=!0,e.login=()=>{e.errorText="Logging In...",r.send(r.urlf("/api/v1/login",{username:e.username,password:e.password,time:Math.floor((new Date).getTime()/1e3)}),null,null).then(r=>{var o=JSON.parse(r);1==o.success?(n.cancel(),t("my_drive")):(e.errorText=o.reason,e.$apply())}).catch(n=>{e.errorText=n,e.$apply()})}}function p(e,n,r,t){e.name=t.name,e.src=r.urlf("/api/v1/drive/stream",{id:t.id});var o=t.name.substr(t.name.lastIndexOf(".")+1).toLowerCase();i.indexOf(o)>=0?e.type="image":s.indexOf(o)>=0?e.type="audio":c.indexOf(o)>=0?e.type="video":e.type="unknown",e.cancel=()=>{n.cancel()}}u.directive("onChange",a.onChange),u.factory("globals",l),u.controller("chipdrivectrl",["$scope","$mdDialog","globals",(e,n,r)=>{e.onerror=n=>{"ERR_LOGIN_REQUIRED"==n?e.login():(e.showSpinner=!1,e.showError=!0,e.errorMsg=n,e.$apply())},e.list=async n=>{null==n&&(n=e.root),e.items=[],e.showEmptyPlaceholder=!1,e.showProgress=!1,e.showError=!1,e.showSpinner=!0,r.send(r.urlf("/api/v1/drive/list",{folderid:n}),null,null).then(r=>{var t=JSON.parse(r).data.list;e.showSpinner=!1,e.items=t,e.currentFolder=n,0==t.length&&(e.showEmptyPlaceholder=!0),e.$apply()}).catch(n=>{e.onerror(n)})},e.upload=async n=>{e.items=[],e.showProgress=!0;for(var t=0,o=0,l=n.target.files,a=0;a<l.length;a++)t+=l[a].size;for(a=0;a<l.length;a++)try{await r.send(r.urlf("/api/v1/drive/upload",{folderid:e.currentFolder,name:l[a].name}),l[a],n=>{var r=(o+n.loaded)/t*100;e.progress=r.toFixed(2),e.$apply()}),o+=l[a].size}catch(n){e.onerror(n)}e.showProgress=!1,e.list(e.currentFolder)},e.createFolder=()=>{var t=n.prompt().title("How would you like to name your new folder?").textContent("").placeholder("NewFolder1").required(!0).ok("Okay").cancel("Cancel");n.show(t).then((function(n){e.items=[],e.showSpinner=!0,r.send(r.urlf("/api/v1/drive/folder",{folderid:e.currentFolder,name:n}),null,null).then(()=>{e.showSpinner=!1,e.list(e.currentFolder)}).catch(n=>{e.onerror(n)})})).catch(e=>{})},e.renameItem=t=>{var o=n.prompt().title("Rename Item").textContent("").placeholder("").required(!0).ok("Okay").cancel("Cancel");n.show(o).then((function(n){e.items=[],e.showSpinner=!0,r.send(r.urlf("/api/v1/drive/rename",{itemid:t.id,name:n}),null,null).then(()=>{e.showSpinner=!1,e.list(e.currentFolder)}).catch(n=>{e.onerror(n)})})).catch(e=>{})},e.deleteItem=t=>{var o=n.confirm().title("Delete Item?").textContent("").ok("Okay").cancel("Cancel");n.show(o).then((function(){e.items=[],e.showSpinner=!0,r.send(r.urlf("/api/v1/drive/delete",{itemid:t.id}),null,null).then(()=>{e.showSpinner=!1,e.list(e.currentFolder)}).catch(n=>{e.onerror(n)})})).catch(e=>{})},e.downloadItem=e=>{var t=r.urlf("/api/v1/drive/stream",{id:e.id}),o=document.createElement("a");o.style.display="none",o.style.height="0px",o.href=t,o.download=e.name,document.body.appendChild(o),o.click(),document.body.removeChild(o),n.cancel()},e.chooseUpload=()=>{o()("#upload-hidden").trigger("click")},e.openItem=(r,t)=>{switch(r.type){case 1:n.show({controller:p,locals:{item:r},templateUrl:"template/dialog.html",parent:angular.element(document.body),targetEvent:t,clickOutsideToClose:!0,fullscreen:e.customFullscreen});break;case 2:e.list(r.id)}},e.login=()=>{n.show({controller:d,locals:{init:e.init},templateUrl:"template/login.html",parent:angular.element(document.body),clickOutsideToClose:!1,fullscreen:e.customFullscreen})},e.init=n=>{r.send(r.urlf("/api/v1/drive/config",{driveid:n}),null,null).then(n=>{var r=JSON.parse(n).data;e.root=r.root,e.list(null)}).catch(n=>{e.onerror(n)})},e.init("my_drive"),e.navItem="my_drive"}]),d.$inject=["$scope","$mdDialog","globals","init"],p.$inject=["$scope","$mdDialog","globals","item"]},,,,,,,,,,function(e,n,r){},function(e,n,r){},function(e,n,r){},function(e,n,r){},function(e,n,r){},function(e,n){e.exports=function(){return{send:(e,n,r)=>new Promise((t,o)=>{var l=new XMLHttpRequest;l.onreadystatechange=function(){4==l.readyState&&(200==l.status?t(l.response):401==l.status?o("ERR_LOGIN_REQUIRED"):o("ERR_UNKNOWN_STATUS"))},l.onerror=function(e){o(e)},l.upload.addEventListener("progress",r),l.open("POST",e,!0),l.send(n)}),urlf:(e,n)=>{var r=e,t=Object.keys(n).length;t>0&&(r+="?");for(var o=0;o<t;o++)r+=encodeURIComponent(Object.keys(n)[o]),r+="=",r+=encodeURIComponent(Object.values(n)[o]),t-1!=o&&(r+="&");return r}}}},function(e,n){e.exports={onChange:function(){return{restrict:"A",link:function(e,n,r){var t=e.$eval(r.onChange);n.on("change",t),n.on("$destroy",(function(){n.off()}))}}}}}]);